

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mass Conservation Approach Walkthrough &mdash; CRNT4SBML 0.0.6 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Semi-diffusive Approach Walkthrough" href="injectivity_walkthrough.html" />
    <link rel="prev" title="Low Deficiency Approach" href="basic_crnt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CRNT4SBML
          

          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">CRNT4SBML</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="detect_bistability.html">Steps for Detecting Bistability</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="physiological_bounds.html">Creating Physiological Bounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="celldesigner_walkthrough.html">CellDesigner Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_crnt.html">Low Deficiency Approach</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mass Conservation Approach Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="injectivity_walkthrough.html">Semi-diffusive Approach Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_opt.html">Numerical Optimization Routine</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_cont.html">Numerical Continuation Routine</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_eq_manifold.html">Creating the Equilibrium Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="generating_c_graphs.html">Generating Presentable C-graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="more_examples.html">Further Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CRNT4SBML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Mass Conservation Approach Walkthrough</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/deficiency_walkthrough.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mass-conservation-approach-walkthrough">
<span id="my-deficiency-label"></span><h1>Mass Conservation Approach Walkthrough<a class="headerlink" href="#mass-conservation-approach-walkthrough" title="Permalink to this headline">¶</a></h1>
<p>Using the SBML file constructed as in <a class="reference internal" href="celldesigner_walkthrough.html#my-celldesigner-label"><span class="std std-ref">CellDesigner Walkthrough</span></a>, we will proceed by completing a more in-depth
explanation of running the mass conservation approach of <a class="reference internal" href="zbibliography.html#irene" id="id1">[OMYS17]</a>. Note that the mass conservation approach can
be ran on any network that has conservation laws, even if that network does have a sink/source. One can test whether or
not there are conservation laws by seeing if the output of <a class="reference internal" href="classes/crnt4sbml.Cgraph.html#crnt4sbml.Cgraph.get_dim_equilibrium_manifold" title="crnt4sbml.Cgraph.get_dim_equilibrium_manifold"><code class="xref py py-func docutils literal notranslate"><span class="pre">crnt4sbml.Cgraph.get_dim_equilibrium_manifold()</span></code></a> is
greater than zero. This tutorial will use <a class="reference download internal" download="" href="_downloads/bcd2bc3e86abed018b753924801a6c6f/Fig1Ci.xml"><code class="xref download docutils literal notranslate"><span class="pre">Fig1Ci.xml</span></code></a>.
The following code will import crnt4sbml and the SBML file. For a little more detail on this process consider <a class="reference internal" href="basic_crnt.html#my-basic-label"><span class="std std-ref">Low Deficiency Approach</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">crnt4sbml</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">crnt4sbml</span><span class="o">.</span><span class="n">CRNT</span><span class="p">(</span><span class="s2">&quot;/path/to/Fig1Ci.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If we then want to conduct the mass conservation approach of <a class="reference internal" href="zbibliography.html#irene" id="id2">[OMYS17]</a>, we must first initialize the
mass_conservation_approach, which is done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">get_mass_conservation_approach</span><span class="p">()</span>
</pre></div>
</div>
<p>This command creates all the necessary information to construct the optimization problem to be solved. Along with this,
the initialization will also attempt to obtain a linear form of the Equilibrium Manifold. Note that this process may take
several minutes for larger networks. For more detail on this process consider <a class="reference internal" href="creating_eq_manifold.html#manifold-label"><span class="std std-ref">Creating the Equilibrium Manifold</span></a>. The following is the
output provided by the initialization:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Creating Equilibrium Manifold ...
Elapsed time for creating Equilibrium Manifold: 0.6395479999999996

Solving for species&#39; concentrations ...
Elapsed time for finding species&#39; concentrations: 1.3528160000000007
</pre></div>
</div>
<p>One very important value that must be provided to the optimization problem are the bounds for the decision vector of the
optimization problem. For this reason, it is useful to see what decision vector was constructed. To do this one can add
the following command to the script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">get_decision_vector</span><span class="p">())</span>
</pre></div>
</div>
<p>This provides the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[re1, re1r, re2, re3, re3r, re4, re5, re5r, re6, s2, s6, s15]
</pre></div>
</div>
<p>To obtain more available functions  that this initialization provides, see <a class="reference internal" href="classes/crnt4sbml.MassConservationApproach.html#crnt4sbml.MassConservationApproach" title="crnt4sbml.MassConservationApproach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">crnt4sbml.MassConservationApproach()</span></code></a>.
Using the decision vector provided, one can then construct the bounds which are necessary for the optimization problem
by creating a list of tuples where the first element corresponds to the lower bound value of the parameter and the second
element is the upper bound value of the parameter.</p>
<p>In addition to the bounds for the decision vector, we must also supply the bounds for those species’ concentrations that
are not defined in the decision vector. To see the order and those species’ concentration bounds that you need to provide
bounds for, we can use the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">get_concentration_bounds_species</span><span class="p">())</span>
</pre></div>
</div>
<p>This provides the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[s1, s3, s7, s16]
</pre></div>
</div>
<p>This tells us that we need to provide a list of four tuples that correspond to the lower and upper bounds for the
species s1, s3, s7, and s16, in that order.</p>
<p>As creating these bounds is not initially apparent to novice users or may become cumbersome, we have created a function
call that will automatically generate physiological bounds based on the C-graph. To use this functionality one can
add the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bnds</span><span class="p">,</span> <span class="n">conc_bnds</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">get_optimization_bounds</span><span class="p">()</span>
</pre></div>
</div>
<p>This provides the following values:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>bnds = [(1e-08, 0.0001), (1e-05, 0.001), (0.001, 1.0), (1e-08, 0.0001), (1e-05, 0.001), (0.001, 1.0),
        (1e-08, 0.0001), (1e-05, 0.001), (0.001, 1.0), (0.5, 500000.0), (0.5, 500000.0), (0.5, 500000.0)]

conc_bnds = [(0.5, 500000.0), (0.5, 500000.0), (0.5, 500000.0), (0.5, 500000.0)]
</pre></div>
</div>
<p>For more information and the correctness on these bounds please refer to <a class="reference internal" href="physiological_bounds.html#physio-bnds-label"><span class="std std-ref">Creating Physiological Bounds</span></a>.</p>
<p>The next most important parameter for optimization is the number of initial points in the feasible point method (please
see <a class="reference internal" href="numerical_opt.html#my-optimization-label"><span class="std std-ref">Numerical Optimization Routine</span></a> for a detailed description of the optimization routine). It is usually good practice to
run the optimization with 100 initial points and observe the minimum objective function value achieved. If an objective
function value smaller than machine epsilon is not achieved, it is best to rerun the optimization with more initial
points. If 10000 or more points are used and an objective function value smaller than machine epsilon is not achieved,
then it is possible that the network does not produce bistability (although this test does not exclude the possibility
for bistability to exist, as stated in the theory). We state the number of feasible points below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num_itr</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>The last values that can be defined before the optimization portion are the sys_min_val which states what value of the
objective function should be considered as zero (below we set this to machine epsilon), the seed for the random number
generation in the optimization method (below we set this to 0 so we can reproduce the results, None should be used if we
want the method to be random), the print_flag which tells the program if the objective function value and decision
vector for the feasible point and multi-start method should be printed out (here we set it to False, which means no
output will be provided), and numpy_dtype which tells the program the numpy data type that should be used in the
optimization method (here we set it to a float with 64 bits). Note that higher precision data types will increase the
runtime of the optimization, but may produce better results. See <a class="reference internal" href="classes/crnt4sbml.MassConservationApproach.html#crnt4sbml.MassConservationApproach.run_optimization" title="crnt4sbml.MassConservationApproach.run_optimization"><code class="xref py py-func docutils literal notranslate"><span class="pre">crnt4sbml.MassConservationApproach.run_optimization()</span></code></a>
for the default values of the routine.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">sys_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">prnt_flg</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">num_dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span>
</pre></div>
</div>
<p>Using these values, we run the optimization problem using the following command, which returns a list of the parameters
(which correspond to the decision vectors) and corresponding objective function values that produce an objective function
value smaller than machine epsilon.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params_for_global_min</span><span class="p">,</span> <span class="n">obj_fun_val_for_params</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">run_optimization</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">,</span> <span class="n">concentration_bounds</span><span class="o">=</span><span class="n">conc_bnds</span><span class="p">,</span>
                                                                     <span class="n">iterations</span><span class="o">=</span><span class="n">num_itr</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">sd</span><span class="p">,</span> <span class="n">print_flag</span><span class="o">=</span><span class="n">prnt_flg</span><span class="p">,</span>
                                                                     <span class="n">numpy_dtype</span><span class="o">=</span><span class="n">num_dtype</span><span class="p">,</span> <span class="n">sys_min_val</span><span class="o">=</span><span class="n">sys_min</span><span class="p">)</span>
</pre></div>
</div>
<p>The following is the output obtained by the constructed model:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Running feasible point method for 100 iterations ...
Elapsed time for feasible point method: 29.199651999999997

Running the multistart optimization ...

Smallest value achieved by objective function: 0.0

Elapsed time for multistart method: 136.14538600000003
</pre></div>
</div>
<p>At this point it may also be helpful to generate a report on the optimization routine that provides more information.
To do this execute the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
</pre></div>
</div>
<p>This will provide the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The number of feasible points that satisfy the constraints: 99
Total feasible points that give F(x) = 0: 28
Total number of points that passed final_check: 28
</pre></div>
</div>
<p>The first line tells one how many initial points satisfy the constraints after the feasible point method is ran. Note
that there should always be a nonzero amount provided here, if a nonzero amount is not given, new bounds should be
considered. The second line describes how many feasible points provide an objective function value smaller than sys_min_val.
The last line outputs the number of feasible points that produce an objective function value smaller than sys_min_val
that also pass all of the constraints of the optimization problem. Note that it is not uncommon for the value provided
in the last line to be smaller than the value provided in the second line. Given the optimization may take a long time
to complete, it may be important to save the parameters produced by the optimization. This can be done as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>numpy.save(&#39;params.npy&#39;, params_for_global_min)
</pre></div>
</div>
<p>this saves the list of numpy arrays representing the parameters into the npy file params. The user can then load these
values at a later time by using the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>params_for_global_min = numpy.load(&#39;params.npy&#39;)
</pre></div>
</div>
<p>Now that we have obtained some parameters that have achieved an objective function value smaller than sys_min_val, we
can conduct numerical continuation to see if the parameters produce bistability for the ODE system provided by the
network. The most important parameters that must be provided by the user are the principal continuation parameter (PCP)
and the species you would like to compare it against. For more information on numerical continuation and these values
see <a class="reference internal" href="numerical_cont.html#my-continuation-label"><span class="std std-ref">Numerical Continuation Routine</span></a>. To select the PCP one needs to know which conservation law to choose. The following
command will provide the conservation laws derived by the deficiency manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">get_conservation_laws</span><span class="p">())</span>
</pre></div>
</div>
<p>This provides the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C1 = 1.0*s16 + 1.0*s7
C2 = 1.0*s2 + 1.0*s3
C3 = 1.0*s1 + 2.0*s15 + 1.0*s16 + 1.0*s3 + 1.0*s6
</pre></div>
</div>
<p>here the left hand side of the equation corresponds to the constant that reflects the total amount of the leading species.
It is one of these constants that should be provided to the numerical continuation routine. For this example we choose
a PCP of C3 (total amount of species <img class="math" src="_images/math/0043fe6507e9b1d112e07a2801e24927e267dd50.png" alt="A"/>) and the species s15 (species <img class="math" src="_images/math/101372b5647e881030b1ce398f305f1b063fde7f.png" alt="AA^*"/>) for the y-axis of the
bifurcation diagram.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spcs</span> <span class="o">=</span> <span class="s2">&quot;s15&quot;</span>
<span class="n">PCP_x</span> <span class="o">=</span> <span class="s2">&quot;C3&quot;</span>
</pre></div>
</div>
<p>Now we can call the numerical continuation routine. First we set the species and pass in the parameters we obtained from
the optimization routine. The next input we provide is a dictionary representation of the AUTO 2000 parameters, to obtain
a description of these parameters and more options refer to <a class="reference download internal" download="" href="_downloads/63e7f39b5fcbf412c2e8da659a8d6871/auto2000_input.pdf"><code class="xref download docutils literal notranslate"><span class="pre">AUTO</span> <span class="pre">parameters</span></code></a>. Please note
that one should <strong>not</strong> set ‘SBML’ or ‘ScanDirection’ in these parameters as these are automatically assigned. It is
absolutely necessary to set PrincipalContinuationParameter in this dictionary.</p>
<p>Here we set the maximum stepsize for numerical continuation, DSMAX to 1e3. However, for certain runs of the numerical
continuation this may produce jagged plots. Smaller values should be used if one wants to obtain a smoother plot,
although it should be noted that this will increase the runtime of the numerical continuation. We also state the
principal continuation parameter range by defining ‘RL0’ and ‘RL1’, the lower and upper bound for the parameter,
respectively. In addition to this range, the lower and upper bounds for the measure of the error is also provided as
‘A0’ and ‘A1’, respectively.</p>
<p>Once we have set the AUTO parameters, we tell the numerical continuation routine whether or not to print out the labels
obtained by the numerical continuation routine. Please refer to <a class="reference internal" href="numerical_cont.html#my-continuation-label"><span class="std std-ref">Numerical Continuation Routine</span></a> for a description of this
print out. The next value we provide is the string representation of the directory where we would like to store the
multistability plots, if any are found (here we choose to create the stability_graphs directory in the current directory).
The last value provided is an error_log_flag which tells the numerical continuation routine whether or not the log
output provided by AUTO is suppressed.</p>
<p>Using this input we can now run the numerical continuation routine on the parameters that pass the constraints of the
optimization problem and produce an objective function value smaller than sys_min_val. This is done below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">multistable_param_ind</span><span class="p">,</span> <span class="n">plot_specifications</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">run_continuity_analysis</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">spcs</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params_for_global_min</span><span class="p">,</span>
                                                                         <span class="n">auto_parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PrincipalContinuationParameter&#39;</span><span class="p">:</span> <span class="n">PCP_x</span><span class="p">,</span>
                                                                                          <span class="s1">&#39;RL0&#39;</span><span class="p">:</span> <span class="mf">1e2</span><span class="p">,</span> <span class="s1">&#39;RL1&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;A0&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">:</span> <span class="mf">5e6</span><span class="p">,</span>
                                                                                          <span class="s1">&#39;DSMAX&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">},</span>
                                                                         <span class="n">print_lbls_flag</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s2">&quot;./stability_graphs&quot;</span><span class="p">,</span>
                                                                         <span class="n">error_log_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to putting the multistability plots found into the path dir_path, this routine will also return the indices of
params_for_global_min that correspond to these plots named “multistable_param_ind” above. Along with these indices,
the routine will also return the plot specifications for each element in “multistable_param_ind” that specify the range
used for the x-axis, y-axis, and the x-y values for each special point in the plot (named “plot_specifications” above).
Also note that if multistability plots are produced, the plot names will have the following form:
PCP_species id_index of params_for_global.png. The output provided by the numerical continuation run is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Running continuity analysis ...
Elapsed time for continuity analysis: 25.02327585220337
</pre></div>
</div>
<p>Again, we can generate a report that will contain the numerical optimization routine output and the now added information
provided by the numerical continuation run.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
</pre></div>
</div>
<p>This provides the following output that describes that of the 28 parameter sets that passed the constraints of the
optimization problem, 14 of them produce multistability for the given input. In addition to this, it also tells one the
indices in params_for_global_min that produce multistability. In practice, larger ranges for the principal continuation
parameter may be needed, but this will increase the runtime of the numerical continuation routine.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The number of feasible points that satisfy the constraints: 99
Total feasible points that give F(x) = 0: 28
Total number of points that passed final_check: 28
Number of multistability plots found: 14
Elements in params_for_global_min that produce multistability:
[4, 11, 12, 14, 15, 16, 19, 20, 21, 22, 23, 24, 26, 27]
</pre></div>
</div>
<p>The following is a bistability plot produced by element 26 of params_for_global_min. Here the solid blue line
indicates stability, the dashed blue line is instability, and the red stars are the special points produced by the
numerical continuation.</p>
<img alt="_images/fig_1Ci_C3_vs_s15_26.png" src="_images/fig_1Ci_C3_vs_s15_26.png" />
<p>In addition to providing this more hands on approach to the numerical continuation routine, we also provide a greedy
version of the numerical continuation routine. With this approach the user just needs to provide the species, parameters,
and PCP. This routine does not guarantee that all multistability plots will be found, but it does provide a good place to
start finding multistability plots. Once the greedy routine is ran, it is usually best to return to the more hands on
approach described above. Note that as stated by the name, this approach is computationally greedy and will take a longer
time than the more hands on approach. Below is the code used to run the greedy numerical continuation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">multistable_param_ind</span><span class="p">,</span> <span class="n">plot_specifications</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">run_greedy_continuity_analysis</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">spcs</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params_for_global_min</span><span class="p">,</span>
                                                                                <span class="n">auto_parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PrincipalContinuationParameter&#39;</span><span class="p">:</span> <span class="n">PCP_x</span><span class="p">})</span>

<span class="n">opt</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
</pre></div>
</div>
<p>This provides the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Running continuity analysis ...
Elapsed time for continuity analysis: 143.82169270515442

The number of feasible points that satisfy the constraints: 99
Total feasible points that give F(x) = 0: 28
Total number of points that passed final_check: 28
Number of multistability plots found: 19
Elements in params_for_global_min that produce multistability:
[3, 4, 6, 7, 11, 12, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27]
</pre></div>
</div>
<p>Note that some of these plots will be jagged or have missing sections in the plot. To produce better plots the hands on
approach should be used.</p>
<p>For more examples of running the mass conservation approach please see <a class="reference internal" href="more_examples.html#further-examples-label"><span class="std std-ref">Further Examples</span></a>.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="injectivity_walkthrough.html" class="btn btn-neutral float-right" title="Semi-diffusive Approach Walkthrough" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic_crnt.html" class="btn btn-neutral float-left" title="Low Deficiency Approach" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Brandon Reyes

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>